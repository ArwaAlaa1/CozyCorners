@model CustomerCart
@{
    ViewData["Title"] = "GetCart";
   
}
<div class="container mt-5">
    <h2 class="text-center">Shopping Cart</h2>

    @if (Model.CartItems != null && Model.CartItems.Any())
    {
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Product Name</th>
                    <th>Category</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>Subtotal</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var item in Model.CartItems)
                {
                    <tr>
                        <td>@item.ProductName</td>
                        <td>@item.Category</td>
                        <td>$@item.Price</td>
                        <td>
                            <div class="input-group">
                                <button class="btn btn-outline-secondary" onclick="changeQuantity('@item.Id', -1)">-</button>
                                <input type="number" class=" text-center" value="1" @* value="@item.Quantity"  *@ readonly />
                                <button class="btn btn-outline-secondary" onclick="changeQuantity('@item.Id', 1)">+</button>
                            </div>
                        </td>
                        <td>@((item.Price * item.Quantity))</td>
                        <td>
                            <button class="btn btn-danger" onclick="removeItem('@item.Id')">Remove</button>
                        </td>
                    </tr>
                }
            </tbody>
        </table>

        <div class="row">
            <div class="col-md-8"></div>
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Order Summary</h5>
                        <p>Subtotal: <strong>$<span id="subtotal">@Model.CartItems.Sum(x => x.Price * x.Quantity)</span></strong></p>
                        <a href="@Url.Action("Checkout", "Cart")" class="btn btn-primary">Proceed to Checkout</a>
                    </div>
                </div>
            </div>
        </div>
    }
    else
    {
        <p class="text-center">Your cart is empty.</p>
    }
</div>

@section Scripts {
    <script>
        function changeQuantity(productId, change) {
            // Get the quantity input
            const quantityInput = document.querySelector(`input[value="${productId}"]`);
            let currentQuantity = parseInt(quantityInput.value);

            // Update the quantity
            currentQuantity += change;
            if (currentQuantity < 0) currentQuantity = 0;

            quantityInput.value = currentQuantity;

            // Update subtotal
            updateSubtotal();
        }

        function updateSubtotal() {
            let subtotal = 0;

            // Calculate subtotal from quantity and price
            document.querySelectorAll('tbody tr').forEach(row => {
                const price = parseFloat(row.cells[2].innerText.replace('$', ''));
                const quantity = parseInt(row.querySelector('input').value);
                subtotal += price * quantity;
            });

            // Update subtotal display
            document.getElementById('subtotal').innerText = subtotal.toFixed(2);
        }

        function removeItem(productId) {
            // Logic to remove item from the cart
            // For example, send an AJAX request to remove the item from the server
        }
    </script>
}